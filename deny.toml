# cargo-deny configuration
# https://embarkstudios.github.io/cargo-deny/

[graph]
targets = [
    "x86_64-unknown-linux-gnu",
    "x86_64-pc-windows-msvc",
    "x86_64-apple-darwin",
    "aarch64-apple-darwin",
]

# =============================================================================
# Advisories - Security vulnerability and unmaintained crate checks
# =============================================================================
[advisories]
db-path = "~/.cargo/advisory-db"
db-urls = ["https://github.com/rustsec/advisory-db"]

# Unmaintained crates: only error on workspace crates, warn on transitive
unmaintained = "workspace"

# No known advisories to ignore after migrating from tiberius to mssql-client
ignore = []

# =============================================================================
# Licenses - Only list licenses actually used by dependencies
# =============================================================================
[licenses]
allow = [
    "Apache-2.0",
    "BSD-3-Clause",
    "CDLA-Permissive-2.0",  # webpki-roots (Mozilla CA certificates)
    "ISC",
    "MIT",
    "OpenSSL",              # aws-lc-sys (TLS crypto library)
    "Unicode-3.0",
    "Zlib",                 # foldhash (hashmap implementation)
]
confidence-threshold = 0.8

# =============================================================================
# Bans - Prevent specific crates or duplicate versions
# =============================================================================
[bans]
# Duplicate crate versions - warn but don't fail
# After migrating from tiberius to mssql-client, remaining duplicates are
# primarily from dev dependencies (testcontainers/bollard):
# - base64: 0.21 (docker_credential) vs 0.22 (rmcp, bollard, etc.)
# - darling: 0.21 (serde_with) vs 0.23 (rmcp-macros)
# - getrandom: version differences in ring/uuid chains
# These are all in the test/dev dependency chain and don't affect production.
multiple-versions = "warn"
wildcards = "warn"
highlight = "all"
deny = []
allow = []
skip = []

# =============================================================================
# Sources - Restrict where crates can be fetched from
# =============================================================================
[sources]
unknown-registry = "deny"
unknown-git = "deny"
allow-registry = ["https://github.com/rust-lang/crates.io-index"]
allow-git = []
